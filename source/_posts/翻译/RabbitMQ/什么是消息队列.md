---
title: 什么是消息队列？
date: 2018-11-29 14:42:11
tags: [编程,分布式,消息队列]
categories: 消息队列	
---



消息队列的简介
<!-- more -->

# 什么是消息队列？

#### 消息与队列

- 什么是队列？

  队列是一种`FIFO`线性表，即按固定顺序排列的对象依次进行处理。 `消息队列`是在应用之间发送消息的队列， 它包括一系列等待处理的工作对象集合。

- 什么是消息

  消息是在发送方应用和接收方应用之间传输的数据; 它实际上是一个有着头信息的(`header`)字节数组。 一个消息可以是传输到一个系统启动一个任务的消息，也可以仅仅是一个普通的消息。



消息队列的基本架构很简单，有一种名为生产者的客户端应用，生产者创建消息并将它们发送到消息队列。 另一种名为消费者的应用程序连接到消息队列，并从队列中获取需要处理的消息。 消息放置到队列中，直到消费者检索它们为止。

#### 消息队列

消息队列是一种应用间的通信方式，消息发送后可以立即返回，有消息系统来确保信息的可靠专递。消息队列提供异步通信协议，将消息放入消息队列的系统不需要对后续处理立即响应。

 电子邮件可能是最好的异步消息传递的例子， 当一封电子邮件被发送时，发送者可以继续处理其他事情而不需要等待接收者立即回应。 这种处理消息的方式将生产者与消费者分离。 消息的生产者和消费者不需要同时与消息队列交互。

![mail](https://www.cloudamqp.com/img/blog/message-queue-small.png)

####　消息队列的优点

 - 解耦与可扩展性

   *耦合*，是用来描述系统的一部分多大程度上依赖于系统的另一部分, 解耦即是将它们分开的过程，以使它们的功能更加独立，更容易扩展。

   *无耦合系统*，即是两个或多个系统能够在不互相连接的情况下进行通信时，此时这些系统可以保持完全的自主性，彼此之间互不知道。 无耦合通常是结构良好的应用标志。 它通常更容易维护、扩展和调试。

   如果无耦合系统中的一个进程无法处理来自队列的消息，那么仍然可以将其他消息添加到队列中，并在系统恢复时对其进行处理。 此外，还可以使用消息队列来延迟处理生产者向队列发送的消息。 在指定的时间，接收者启动并处理队列中的消息。一个消息可以被存储与转发，，直到消息被处理。

   ![message queue](https://www.cloudamqp.com/img/blog/message-queue-example.png)

   与其构建一个大型应用程序，不如将应用程序的不同部分分离开来，只在它们之间使用消息进行异步通信,处于一种无耦合状态。 通过这种方式，应用程序的不同部分可以独立发展，可以用不同的语言编写，或者由不同的开发人员团队进行维护。

#### 简单的例子

假设一个 web 服务，它每秒钟接收许多请求，请求不会丢失，所有请求都需要通过一个耗时的流程处理。

想象一下，这样的 web 服务必须始终具有高可用性，并随时准备接收新请求，而不是像以前处理请求一样，直接锁死服务。 在这种情况下，最好在 web 服务和处理业务的服务之间放置一个消息队列。 Web 服务可以将"`start processing`"——这样的消息放到队列中，另一个进程可以按顺序接收和处理消息。 这两个过程将彼此分离，并且不需要彼此等待。 如果在短时间内有大量请求，系统将按照数据库能处理的并发量，从消息队列中慢慢拉取消息。在生产中，这个短暂的高峰期积压是允许的。可以想象当业务和工作负载增长，就需要扩展系统了。 现在需要做的就是增加更多的`workder`和`receiver`，以加快队列的工作速度。。

